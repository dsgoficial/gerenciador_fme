angular.module("cgBusy",[]),angular.module("cgBusy").factory("_cgBusyTrackerFactory",["$timeout","$q",function(a,b){return function(){var c={},d=function(a){if(!c.isPromise(a))throw new Error("cgBusy expects a promise (or something that has a .promise or .$promise");-1===c.promises.indexOf(a)&&(c.promises.push(a),c.callThen(a,function(){a.$cgBusyFulfilled=!0,-1!==c.promises.indexOf(a)&&c.promises.splice(c.promises.indexOf(a),1)},function(b){c.errors.push(b),a.$cgBusyFulfilled=!0,-1!==c.promises.indexOf(a)&&c.promises.splice(c.promises.indexOf(a),1)}))};return c.promises=[],c.errors=[],c.delayPromise=null,c.durationPromise=null,c.delayJustFinished=!1,c.reset=function(b){c.minDuration=b.minDuration,c.promises=[],c.errors.splice(0,c.errors.length),angular.forEach(b.promises,function(a){a&&!a.$cgBusyFulfilled&&d(a)}),0!==c.promises.length&&(c.delayJustFinished=!1,b.delay&&(c.delayPromise=a(function(){c.delayPromise=null,c.delayJustFinished=!0},parseInt(b.delay,10))),b.minDuration&&(c.durationPromise=a(function(){c.durationPromise=null},parseInt(b.minDuration,10)+(b.delay?parseInt(b.delay,10):0))))},c.isPromise=function(a){var b=a&&(a.then||a.$then||a.$promise&&a.$promise.then);return"undefined"!=typeof b},c.callThen=function(a,c,d){var e;a.then||a.$then?e=a:a.$promise?e=a.$promise:a.denodeify&&(e=b.when(a));var f=e.then||e.$then;f.call(e,c,d)},c.active=function(){return c.delayPromise?!1:c.delayJustFinished?(c.delayJustFinished=!1,0===c.promises.length&&(c.durationPromise=null),c.promises.length>0):c.durationPromise?!0:c.promises.length>0},c.hasError=function(){return c.errors.length>0},c}}]),angular.module("cgBusy").provider("cgBusyProfiles",function(){this.profiles={},this.addProfile=function(a,b){if(!a)throw new Error("profileName must be provided");if(!angular.isObject(b))throw new Error("profileValues must be an object!");return this.profiles[a]=b,this.profiles[a]},this.$get=function(){var a=this.profiles;return{get:function(b){return a[b]},keys:function(){var b,c=[];for(b in a)a.hasOwnProperty(b)&&c.push(b);return c}}}}),angular.module("cgBusy").value("cgBusyDefaults",{}),angular.module("cgBusy").directive("cgBusy",["$compile","$templateCache","cgBusyDefaults","cgBusyProfiles","$http","_cgBusyTrackerFactory","$q",function(a,b,c,d,e,f,g){return{restrict:"AE",transclude:!0,link:function(h,i,j,k,l){var m=i.css("position");"static"!==m&&""!==m&&"undefined"!=typeof m||i.css("position","relative");var n,o,p,q,r,s,t,u,v,w=f(),x={templateUrl:"angular-busy.html",delay:0,minDuration:0,backdrop:!0,aria:!0,inline:!1,inlineReplace:!0,inlineErrorClass:"cg-busy-error",message:"Please Wait...",wrapperClass:"cg-busy cg-busy-animation",errorTemplateUrl:void 0};angular.extend(x,c),h.$watchCollection(j.cgBusy,function(c){if(c||(c={promise:null}),angular.isString(c))throw new Error("Invalid value for cg-busy. cgBusy no longer accepts string ids to represent promises/trackers.");(angular.isArray(c)||w.isPromise(c))&&(c={promise:c});var f=angular.extend(angular.copy(x),c);if(f.profile){var k=d.get(c.profile);k&&angular.extend(f,k,c)}c=f,c.templateUrl||(c.templateUrl=x.templateUrl),angular.isArray(c.promise)||(c.promise=[c.promise]),s||(s=h.$new()),s.$message=c.message,s.$errors=w.errors,s.$inline=c.inline||"",angular.equals(w.promises,c.promise)||w.reset({promises:c.promise,delay:c.delay,minDuration:c.minDuration}),s.$cgBusyIsActive=function(){return w.active()},s.$cgBusyHasError=function(){return w.active()?!1:w.hasError()},s.$applyCgBusy=function(a,b){angular.isFunction(u)&&(u(),u=null),c.inline?s.$applyInlineCgBusy(a,b):s.$applyNormalCgBusy(a,b)},s.$applyNormalCgBusy=function(b,d){if(c.backdrop="undefined"==typeof c.backdrop?!0:c.backdrop,c.backdrop){var e='<div class="cg-busy cg-busy-backdrop cg-busy-backdrop-animation ng-hide" ng-show="$cgBusyIsActive()"></div>';o=a(e)(s)}var f='<div class="'+c.wrapperClass+' ng-hide" ng-show="$cgBusyIsActive()">'+b+"</div>";c.errorTemplateUrl&&(f+='<div ng-if="$cgBusyHasError()">'+d+"</div>"),n=a(f)(s),angular.element(n.children()[0]).css({position:"absolute",top:0,left:0,right:0,bottom:0}),l(h,function(a){v=a,i.append(a),c.backdrop&&i.append(o),i.append(n)}),c.aria&&(u=s.$watch("$cgBusyIsActive()",function(a){j.$set("aria-busy",a)}))},s.$applyInlineCgBusy=function(b,d){var e,f='<div class="'+c.wrapperClass+'">'+b+"</div>";n=a(f)(s),l(h,function(a){v=a,i.append(a)}),u=s.$watch("$cgBusyIsActive()",function(b){b?i.append(n):(n.remove(),p&&(p.remove(),p=null),c.errorTemplateUrl&&s.$cgBusyHasError()&&(e='<div class="'+c.inlineErrorClass+'">'+d+"</div>",p=a(e)(s),i.parent().prepend(p))),c.inlineReplace&&v.css("visibility",b?"hidden":""),j.ngDisabled||j.$set("disabled",b)})},n&&q===c.templateUrl&&t===c.backdrop&&r===c.errorTemplateUrl||(n&&n.remove(),o&&o.remove(),q=c.templateUrl,t=c.backdrop,r=c.errorTemplateUrl,g.all({template:e.get(q,{cache:b}),errorTemplate:g.when(r?e.get(r,{cache:b}):{data:null})}).then(function(a){s.$applyCgBusy(a.template.data,a.errorTemplate.data)},function(a){throw new Error("Template(s) specified for cgBusy ("+c.templateUrl+(c.errorTemplateUrl?" or "+c.errorTemplateUrl:"")+") +could not be loaded. "+angular.toJson(a))}))},!0)}}}]),angular.module("cgBusy").run(["$templateCache",function(a){"use strict";a.put("angular-busy.html",'<div class="cg-busy-default-wrapper">\n\n   <div class="cg-busy-default-sign">\n\n      <div class="cg-busy-default-spinner">\n         <div class="bar1"></div>\n         <div class="bar2"></div>\n         <div class="bar3"></div>\n         <div class="bar4"></div>\n         <div class="bar5"></div>\n         <div class="bar6"></div>\n         <div class="bar7"></div>\n         <div class="bar8"></div>\n         <div class="bar9"></div>\n         <div class="bar10"></div>\n         <div class="bar11"></div>\n         <div class="bar12"></div>\n      </div>\n\n      <div class="cg-busy-default-text">{{$message}}</div>\n\n   </div>\n\n</div>')}]);